getScenarioNormal <- function(
  n_subjects,
  true_means,
  cohort_names = seq_along(n_subjects),
  sd,
  n_trials = 1e4
) {
  if (missing(n_subjects))
    stop("Please provide a vector of positive integers for 'n_subjects'")
  if (missing(true_means))
    stop("Please provide a numeric vector for 'true_means'")
  if (missing(sd))
    stop("Please provide a single positive numeric for 'sd'")

  if (length(n_subjects) != length(true_means))
    stop("n_subjects and true_means must have same length")

  if (any(!is.positive.wholenumber(n_subjects)))
    stop("All entries in 'n_subjects' must be positive integers")
  if (!is.single.numeric(sd) || sd <= 0)
    stop("sd must be a single positive numeric")
  if (!is.single.positive.wholenumber(n_trials))
    stop("n_trials must be a single positive integer")

  J     <- length(n_subjects)
  max_n <- max(n_subjects)

  trials <- vector("list", n_trials)

  for (t in seq_len(n_trials)) {
    y_mat <- matrix(NA_real_, nrow = max_n, ncol = J)

    for (j in seq_len(J)) {
      y_mat[seq_len(n_subjects[j]), j] <-
        stats::rnorm(n_subjects[j], mean = true_means[j], sd = sd)
    }

    colnames(y_mat) <- paste0("y_", cohort_names)

    trials[[t]] <- list(
      y          = y_mat,
      n_subjects = n_subjects
    )
  }

  n_subjects_mat <- matrix(
    n_subjects,
    nrow = n_trials,
    ncol = J,
    byrow = TRUE
  )
  colnames(n_subjects_mat) <- paste0("n_", cohort_names)

  previous_gos <- matrix(
    TRUE,
    nrow = n_trials,
    ncol = J + 1L,
    byrow = TRUE
  )
  colnames(previous_gos) <- c("overall", paste0("decision_", cohort_names))

  scenario_data <- list(
    n_subjects        = n_subjects_mat,
    true_means        = true_means,
    sd                = sd,
    trials            = trials,
    previous_analyses = list(
      go_decisions   = previous_gos,
      post_quantiles = NULL
    ),
    n_trials          = n_trials,
    endpoint          = "normal"
  )

  return(scenario_data)
}
