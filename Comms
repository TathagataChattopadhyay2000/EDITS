#' @title saveScenariosNormal
#' @md
#' @description Saves the normal-endpoint scenario data in a newly created or
#'   existing directory.
#' @param scenario_list An object of class `scenario_list_normal`,
#'   e.g. created with `simulateScenariosNormal()`.
#' @param save_path A string providing the path for the directory in which the
#'   scenario files should be created, Default: [base::tempdir()].
#' @return A named list of length 2 with the scenario numbers and the `save_path`.
#' @seealso
#'   [simulateScenariosNormal()],
#'   [loadScenariosNormal()],
#'   [base::tempdir()]
#' @export
saveScenariosNormal <- function(
  scenario_list,
  save_path = tempdir()
) {
  checkmate::assert(
    checkmate::check_class(scenario_list, "scenario_list_normal"),
    checkmate::check_character(save_path, len = 1),
    combine   = "and",
    .var.name = "Please provide an object of class 'scenario_list_normal' for the argument 'scenario_list'"
  )

  if (!dir.exists(save_path)) {
    dir.create(save_path, recursive = TRUE)
  }

  scenario_numbers <- vapply(
    scenario_list,
    function(x) x$scenario_number,
    FUN.VALUE = integer(1L)
  )

  for (s in seq_along(scenario_list)) {
    saveRDS(
      scenario_list[[s]],
      file = file.path(save_path, paste0("scenario_data_", scenario_numbers[s], ".rds"))
    )
  }

  list(
    scenario_numbers = scenario_numbers,
    path             = save_path
  )
}
