model {

# priors
  mu_pop     ~ dnorm(mu_pop_mean, prec_mu_pop)

  prec_tau   ~ dgamma(tau_shape,   tau_rate)   # 1 / tau^2  (between-trial)
  prec_sigma ~ dgamma(sigma_shape, sigma_rate) # 1 / sigma^2 (within-trial)
  
  for (j in 1:J) {

    ## Prior
    theta[j] ~ dnorm(mu_pop, prec_tau)

    ## Likelihood
    y[j] ~ dnorm(theta[j], prec_y[j])
    prec_y[j] <- n[j] * prec_sigma  # precision of mean = n_j / sigma^2
  }

}
