test_that("getBlankString returns requested number of spaces", {
  out0 <- getBlankString(0)
  expect_type(out0, "character")
  expect_length(out0, 0)

  out5 <- getBlankString(5)
  expect_identical(out5, "     ")
  expect_type(out5, "character")
  expect_length(out5, 1)
})

test_that("listPerMethod reshapes scenario-first lists into method-first lists", {

  per_scenario <- list(
    scenario_1 = list(
      berry      = matrix(1:4, nrow = 2),
      stratified = matrix(5:8, nrow = 2)
    ),
    scenario_2 = list(
      berry      = matrix(9:12,  nrow = 2),
      stratified = matrix(13:16, nrow = 2)
    )
  )

  per_method <- listPerMethod(per_scenario)

  expect_setequal(names(per_method), c("berry", "stratified"))
  expect_setequal(names(per_method$berry), c("scenario_1", "scenario_2"))
  expect_setequal(names(per_method$stratified), c("scenario_1", "scenario_2"))

  expect_equal(per_method$berry$scenario_1, per_scenario$scenario_1$berry)
  expect_equal(per_method$berry$scenario_2, per_scenario$scenario_2$berry)

  expect_equal(per_method$stratified$scenario_1, per_scenario$scenario_1$stratified)
  expect_equal(per_method$stratified$scenario_2, per_scenario$scenario_2$stratified)
})
