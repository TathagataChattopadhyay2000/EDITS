getGoDecisionsByCohort <- function (
    
  gamma_quantiles,
  
  boundary_rates = NULL,
  decision_rule  = quote(x > boundary_rates)
  
) {
  
  go_decisions_list <- lapply(
    gamma_quantiles,
    function (x) {
      as.logical(eval(decision_rule))
    }
  )
  
  ## ensure each trial yields a row vector
  go_decisions <- do.call(rbind, lapply(go_decisions_list, function(z) {
    matrix(z, nrow = 1)
  }))
  
  colnames(go_decisions) <- paste0("decision_", seq_len(ncol(go_decisions)))
  
  return(go_decisions)
  
}
