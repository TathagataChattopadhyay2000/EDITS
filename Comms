## Example: normal endpoint + decisions + continueRecruitment to change n

## 1) initial scenario (normal)
sc0 <- simulateScenarios(
  n_subjects_list = list(c(10, 20, 30)),
  means_list      = list(c(2, 3, 4)),
  sds_list        = list(c(1, 1, 1)),
  endpoint        = "normal",
  n_trials        = 50
)

## 2) analyse
an0 <- performAnalyses(
  scenario_list     = sc0,
  method_names      = "normal",
  n_mcmc_iterations = 200,
  nbins             = 5
)

## 3) make a go/no-go rule (example: require 97.5% quantile of theta_j > 2.5)
cohort_names <- paste0("theta_", 1:ncol(sc0$scenario_1$n_subjects))
evidence_levels <- rep(0.975, length(cohort_names))

dec0 <- getGoDecisions(
  analyses_list   = an0,
  cohort_names    = cohort_names,
  evidence_levels = evidence_levels,
  boundary_rules  = quote(c(
    x[1] > 2.5,
    x[2] > 2.5,
    x[3] > 2.5
  )),
  overall_min_gos = 1
)

## 4) continue recruitment: add subjects to recruiting cohorts (this changes n)
## NOTE: for this to work, your scenario must have recruiting cohorts in the sense of your code.
## With your current normal setup, "recruiting" is defined via sds > 0.
sc1 <- continueRecruitment(
  n_subjects_add_list = list(c(5, 5, 5)),
  decisions_list      = dec0,
  method_name         = "normal"
)

## 5) analyse again; uniqueness now includes updated n, so grouping/signatures can change
an1 <- performAnalyses(
  scenario_list     = sc1,
  method_names      = "normal",
  n_mcmc_iterations = 200,
  nbins             = 5
)

## 6) quick check that n changed
head(sc0$scenario_1$n_subjects)
head(sc1$scenario_1$n_subjects)
