    ## true values for comparison (binary: response_rates; normal: true_means)
    if (!is.null(analyses_list[[s]]$scenario_data$response_rates)) {
      
      true_vals <- analyses_list[[s]]$scenario_data$response_rates
      
      ## calculate the historic response rates (binary case)
      hist_index <- true_vals <= 0 | true_vals >= 1
      if (any(hist_index)) {
        
        hist_rr <- sapply(which(hist_index), function (x) {
          true_vals[x] / analyses_list[[s]]$scenario_data$n_subjects[1, x]
        })
        
        true_vals[hist_index] <- hist_rr
      }
      
    } else if (!is.null(analyses_list[[s]]$scenario_data$true_means)) {
      
      ## continuous endpoint: use true means directly
      true_vals <- analyses_list[[s]]$scenario_data$true_means
      
    } else {
      
      stop("scenario_data must contain either 'response_rates' (binary) or 'true_means' (normal).")
      
    }



    true_diff_rr <- sapply(seq_len(nrow(calc_differences)), function (x) {
      
      diff(true_vals[x])
      
    })
    ...
    true_vals <- cbind(true_vals, true_diff_rr)




bias_estimates <- point_estimates - t(true_vals)



    } else {
      if (!is.language(boundary_rules))                                        stop ()
      if (!identical(boundary_rules[1], quote(c())))                           stop ()
      ## fix number of decisions to number of cohorts
      if (!identical(length(boundary_rules) - 1L,
                     length(cohort_names))) stop ()
      eval(boundary_rules)
    }




