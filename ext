continueRecruitmentNormal <- function(
  n_subjects_add_list,
  decisions_list,
  method_name = NULL
) {
  error_n_subjects_add_list <- simpleError(
    "Please provide a list of vectors of non-negative integers for 'n_subjects_add_list'")
  error_decisions_list <- simpleError(
    "Please provide an object of class 'decision_list' for 'decisions_list'")
  error_method_name <- simpleError(
    "Please provide a valid 'method_name' present in decisions_list$scenario_1$decisions_list")

  if (missing(n_subjects_add_list)) stop(error_n_subjects_add_list)
  if (missing(decisions_list))      stop(error_decisions_list)

  if (!is.decision_list(decisions_list)) stop(error_decisions_list)

  ## choose method_name
  if (is.null(method_name)) {
    n_methods <- length(decisions_list$scenario_1$decisions_list)
    if (n_methods > 1) {
      stop(error_method_name)
    } else {
      method_name <- names(decisions_list$scenario_1$decisions_list)
    }
  } else {
    if (!method_name %in% names(decisions_list$scenario_1$decisions_list))
      stop(error_method_name)
  }

  ## recycle n_subjects_add_list if a single vector given
  if (!is.list(n_subjects_add_list)) {
    n_subjects_add_list <- rep(list(n_subjects_add_list), length(decisions_list))
  }

  if (!is.list(n_subjects_add_list) ||
      any(!sapply(n_subjects_add_list, is.non.negative.wholenumber)))
    stop(error_n_subjects_add_list)

  scenario_numbers <- as.numeric(sub("scenario_", "", names(decisions_list)))

  if (length(n_subjects_add_list) != length(decisions_list)) {
    stop(simpleError(
      "The lengths of 'n_subjects_add_list' and 'decisions_list' must be equal"))
  }

  scenario_list <- vector("list", length(decisions_list))
  names(scenario_list) <- paste0("scenario_", scenario_numbers)

  for (s in seq_along(scenario_list)) {

    scen_data <- decisions_list[[s]]$scenario_data
    if (is.null(scen_data$endpoint) || scen_data$endpoint != "normal") {
      stop("continueRecruitmentNormal: scenario_data$endpoint must be 'normal'")
    }

    ## method must be in this scenario
    if (!(method_name %in%
          decisions_list[[s]]$analysis_data$analysis_parameters$method_names)) {
      stop(simpleError("Selected method_name not analyzed in this scenario"))
    }

    n_subjects_add <- n_subjects_add_list[[s]]

    n_subjects <- scen_data$n_subjects        # matrix [n_trials x K]
    trials     <- scen_data$trials            # list of length n_trials
    n_trials   <- scen_data$n_trials
    sd         <- scen_data$sd
    mu_c       <- scen_data$true_means_control
    mu_t       <- scen_data$true_means_treatment

    K <- ncol(n_subjects)

    if (length(n_subjects_add) != K) {
      stop("For normal endpoint, length of n_subjects_add must equal number of cohorts.")
    }
    if (nrow(n_subjects) != n_trials || length(trials) != n_trials) {
      stop("Inconsistent n_trials, n_subjects, or trials in scenario_data.")
    }

    ## decisions for this method
    go_decisions_all <- decisions_list[[s]]$decisions_list[[method_name]]
    previous_gos     <- go_decisions_all

    if ("overall" %in% colnames(go_decisions_all)) {
      overall_gos  <- go_decisions_all[, "overall"]
      go_decisions <- go_decisions_all[, colnames(go_decisions_all) != "overall", drop = FALSE]
    } else {
      overall_gos  <- rep(TRUE, nrow(go_decisions_all))
      go_decisions <- go_decisions_all
    }

    if (!identical(dim(go_decisions), dim(n_subjects))) {
      stop("go_decisions and n_subjects must have same dimension [n_trials x K] for normal endpoint.")
    }

    ## loop over trials and cohorts, add subjects where Go AND overall Go
    for (t in seq_len(n_trials)) {
      if (!overall_gos[t]) next

      tr_t <- trials[[t]]

      for (k in seq_len(K)) {
        if (!go_decisions[t, k]) next

        add_total <- n_subjects_add[k]
        if (add_total <= 0) next

        ## simple split: half control, half treatment
        add_n_control   <- floor(add_total / 2)
        add_n_treatment <- add_total - add_n_control

        ## control arm
        if (add_n_control > 0) {
          yc_new <- stats::rnorm(add_n_control, mean = mu_c[k], sd = sd)
          Xc_new <- matrix(1, nrow = add_n_control, ncol = ncol(tr_t$Xck[[k]]))
          tr_t$yck[[k]] <- c(tr_t$yck[[k]], yc_new)
          tr_t$Xck[[k]] <- rbind(tr_t$Xck[[k]], Xc_new)
          tr_t$nck[k]   <- tr_t$nck[k] + add_n_control
        }

        ## treatment arm
        if (add_n_treatment > 0) {
          yt_new <- stats::rnorm(add_n_treatment, mean = mu_t[k], sd = sd)
          Xt_new <- matrix(1, nrow = add_n_treatment, ncol = ncol(tr_t$Xtk[[k]]))
          tr_t$ytk[[k]] <- c(tr_t$ytk[[k]], yt_new)
          tr_t$Xtk[[k]] <- rbind(tr_t$Xtk[[k]], Xt_new)
          tr_t$ntk[k]   <- tr_t$ntk[k] + add_n_treatment
        }

        ## update total n for this trial & cohort
        n_subjects[t, k] <- tr_t$nck[k] + tr_t$ntk[k]
      }

      trials[[t]] <- tr_t
    }

    ## save updated scenario
    scenario_list[[s]] <- list(
      n_subjects           = n_subjects,
      true_means_control   = mu_c,
      true_means_treatment = mu_t,
      sd                   = sd,
      trials               = trials,
      previous_analyses    = list(
        go_decisions   = previous_gos,
        post_quantiles = decisions_list[[s]]$analysis_data$quantiles_list
      ),
      n_trials             = n_trials,
      endpoint             = "normal"
    )

    scenario_list[[s]]$scenario_number <- scen_data$scenario_number
  }

  class(scenario_list) <- "scenario_list_normal"
  return(scenario_list)
}
